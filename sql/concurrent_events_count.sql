		IF OBJECT_ID('tempdb..#temp_calls')	IS NOT NULL

		BEGIN
			DROP TABLE #temp_calls;
		END

CREATE	TABLE #temp_calls
		(call_no	INT
		, starttime DATETIME
		, endtime	DATETIME
		)

INSERT	INTO #temp_calls
(	  call_no
    , starttime
    , endtime
)
VALUES
  (1, '2009-01-01 00:02:10' , '2009-01-01 00:05:24')
,(301,'2020-08-27 07:41:00','2020-08-27 08:35:00')
,(206,'2020-08-27 07:46:00','2020-08-27 08:09:00')
,(369,'2020-08-27 07:46:00','2020-08-27 08:38:00')
,(363,'2020-08-27 07:56:00','2020-08-27 08:48:00')
,(239,'2020-08-27 07:57:00','2020-08-27 08:47:00')
,(268,'2020-08-27 08:27:00','2020-08-27 09:07:00')
,(497,'2020-08-27 08:50:00','2020-08-27 09:35:00')
,(564,'2020-08-27 08:53:00','2020-08-27 11:47:00')
,(544,'2020-08-27 09:06:00','2020-08-27 10:03:00')
,(789,'2020-08-27 09:07:00','2020-08-27 09:48:00')
,(334,'2020-08-27 09:23:00','2020-08-27 09:57:00')
,(979,'2020-08-27 09:57:00','2020-08-27 11:27:00')
,(817,'2020-08-27 10:02:00','2020-08-27 10:50:00')
,(575,'2020-08-27 10:34:00','2020-08-27 11:12:00')
,(729,'2020-08-27 11:07:00','2020-08-27 11:43:00')
,(352,'2020-08-27 11:34:00','2020-08-27 12:25:00')
,(687,'2020-08-27 11:39:00','2020-08-27 12:05:00')
,(330,'2020-08-27 11:39:00','2020-08-27 12:15:00')
,(110,'2020-08-27 11:45:00','2020-08-27 12:55:00')
,(013,'2020-08-27 12:55:00','2020-08-27 13:37:00')
,(512,'2020-08-27 13:09:00','2020-08-27 14:48:00')


;

WITH C1 AS
(
  SELECT		starttime AS ts
				, 1 AS TYPE
				, ROW_NUMBER() OVER(ORDER BY starttime) AS start_ordinal
  FROM			#temp_calls

  UNION ALL

  SELECT		endtime
				, -1
				, NULL
  FROM			#temp_calls
),
C2 AS
(
  SELECT		*
				, ROW_NUMBER() OVER(  ORDER BY ts, TYPE) AS start_or_end_ordinal
  FROM C1
)

SELECT			MAX(2 * start_ordinal - start_or_end_ordinal) AS mx
FROM			C2
WHERE TYPE = 1
;


